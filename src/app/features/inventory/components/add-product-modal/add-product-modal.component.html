<div class="add-product-modal">
  <div mat-dialog-title class="modal-header">
    <h2>Add New Product</h2>
    <button mat-icon-button (click)="onCancel()" class="close-button">
      <mat-icon>close</mat-icon>
    </button>
  </div>

  <div mat-dialog-content class="modal-content">
    <form [formGroup]="productForm" class="product-form">
      
      <!-- Product Name -->
      <mat-form-field appearance="outline" class="full-width mt-3">
        <mat-label>Product Name</mat-label>
        <input matInput  formControlName="name" />
        <mat-error *ngIf="productForm.get('name')?.invalid && productForm.get('name')?.touched">
          {{ getErrorMessage('name') }}
        </mat-error>
      </mat-form-field>

      <!-- Description -->
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Description</mat-label>
        <textarea matInput 
                  formControlName="description" 
                  rows="3"></textarea>
      </mat-form-field>

      <!-- Barcode with Generate Button -->
      <div class="barcode-section">
        <mat-form-field appearance="outline" class="barcode-input">
          <mat-label>Barcode</mat-label>
          <input matInput 
                 formControlName="barcode" />
          <mat-error *ngIf="productForm.get('barcode')?.invalid && productForm.get('barcode')?.touched">
            {{ getErrorMessage('barcode') }}
          </mat-error>
        </mat-form-field>
        <button type="button" class="retail-pro-btn retail-pro-btn--secondary generate-btn" 
                (click)="generateBarcode()">
          <mat-icon>qr_code</mat-icon>
          Generate
        </button>
      </div>

      <!-- Price and MRP Row -->
      <div class="price-row">
        <mat-form-field appearance="outline" class="price-field">
          <mat-label>Selling Price</mat-label>
          <input matInput 
                 type="number" 
                 formControlName="price" 
                 placeholder=""
                 min="0"
                 step="0.01">
          <span matTextPrefix>₹&nbsp;</span>
          <mat-error *ngIf="productForm.get('price')?.invalid && productForm.get('price')?.touched">
            {{ getErrorMessage('price') }}
          </mat-error>
        </mat-form-field>

        <mat-form-field appearance="outline" class="price-field">
          <mat-label>MRP </mat-label>
          <input matInput 
                 type="number" 
                 formControlName="mrp" 
                 placeholder=""
                 min="0"
                 step="0.01">
          <span matTextPrefix>₹&nbsp;</span>
          <mat-error *ngIf="productForm.get('mrp')?.invalid && productForm.get('mrp')?.touched">
            {{ getErrorMessage('mrp') }}
          </mat-error>
        </mat-form-field>
      </div>

      <!-- Category -->
      <!-- <mat-form-field appearance="outline" class="full-width">
        <mat-label>Category</mat-label>
        <mat-select formControlName="categoryId">
          <mat-option *ngFor="let category of categories" [value]="category.id">
            {{ category.name }}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="productForm.get('categoryId')?.invalid && productForm.get('categoryId')?.touched">
          {{ getErrorMessage('categoryId') }}
        </mat-error>
      </mat-form-field> -->

      <!-- Active Status -->
      <div class="checkbox-section">
        <mat-checkbox formControlName="isActive" color="primary">
          Active Product
        </mat-checkbox>
        <small class="checkbox-help">Inactive products won't appear in sales</small>
      </div>

    </form>
  </div>

  <div mat-dialog-actions class="modal-actions">
    <button type="button" 
            class="retail-pro-btn retail-pro-btn--secondary" 
            (click)="onCancel()">
      Cancel
    </button>
    <button type="button" 
            class="retail-pro-btn retail-pro-btn--primary" 
            (click)="onSubmit()"
            [disabled]="!productForm.valid || isSubmitting">
      <mat-icon *ngIf="!isSubmitting">add</mat-icon>
      <mat-icon *ngIf="isSubmitting" class="spinning">sync</mat-icon>
      {{ isSubmitting ? 'Adding...' : 'Add Product' }}
    </button>
  </div>
</div>