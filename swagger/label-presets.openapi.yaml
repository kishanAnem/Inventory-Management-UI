openapi: 3.0.3
info:
  title: Label Presets API
  version: 1.0.0
  description: |
    API for storing and managing label-printing presets per tenant/user.
    Designed to match Inventory-Management-UI label printing integration.
servers:
  - url: https://localhost:7081
    description: Local development
security:
  - bearerAuth: []
tags:
  - name: Label Presets
    description: CRUD operations for label configuration presets
paths:
  /api/label-presets:
    get:
      tags: [Label Presets]
      summary: List all saved label presets
      operationId: listLabelPresets
      responses:
        '200':
          description: Presets fetched successfully
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/LabelConfiguration'
              examples:
                sample:
                  value:
                    - id: cfg_001
                      name: My Retail 24
                      paperSize: A4
                      pageOrientation: portrait
                      pageWidth: 210
                      pageHeight: 297
                      labelWidth: 52
                      labelHeight: 29
                      labelsPerRow: 4
                      labelsPerColumn: 6
                      horizontalGap: 0
                      verticalGap: 0
                      topMargin: 21
                      leftMargin: 0
                      rightMargin: 0
                      bottomMargin: 21
                      template:
                        id: retail
                        name: Retail Price Tag
                        codeType: CODE128
                        showCode: true
                        fontSize: 9
                        fontFamily: Roboto
                        fields:
                          - fieldName: tenantName
                            displayLabel: ""
                            visible: true
                            fontSize: 7
                            fontWeight: normal
                            alignment: center
                            order: 1
                          - fieldName: name
                            displayLabel: ""
                            visible: true
                            fontSize: 9
                            fontWeight: bold
                            alignment: center
                            order: 2
                          - fieldName: barcode
                            displayLabel: ""
                            visible: true
                            fontSize: 7
                            fontWeight: normal
                            alignment: center
                            order: 3
                          - fieldName: price
                            displayLabel: MRP
                            visible: true
                            fontSize: 10
                            fontWeight: bold
                            alignment: center
                            order: 4
        '401':
          $ref: '#/components/responses/Unauthorized'
    post:
      tags: [Label Presets]
      summary: Create a new label preset
      operationId: createLabelPreset
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LabelConfigurationCreateRequest'
      responses:
        '201':
          description: Preset created
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LabelConfiguration'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'

  /api/label-presets/{id}:
    put:
      tags: [Label Presets]
      summary: Update an existing label preset
      operationId: updateLabelPreset
      parameters:
        - $ref: '#/components/parameters/LabelPresetId'
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LabelConfigurationUpdateRequest'
      responses:
        '200':
          description: Preset updated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LabelConfiguration'
        '400':
          $ref: '#/components/responses/BadRequest'
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

    delete:
      tags: [Label Presets]
      summary: Delete a preset
      operationId: deleteLabelPreset
      parameters:
        - $ref: '#/components/parameters/LabelPresetId'
      responses:
        '204':
          description: Preset deleted
        '401':
          $ref: '#/components/responses/Unauthorized'
        '404':
          $ref: '#/components/responses/NotFound'

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  parameters:
    LabelPresetId:
      name: id
      in: path
      required: true
      schema:
        type: string
      description: Label preset unique identifier

  responses:
    BadRequest:
      description: Invalid request payload
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    Unauthorized:
      description: Authentication required or invalid token
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'
    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            $ref: '#/components/schemas/ErrorResponse'

  schemas:
    ErrorResponse:
      type: object
      properties:
        message:
          type: string
        code:
          type: string
      required: [message]

    LabelConfigurationCreateRequest:
      allOf:
        - $ref: '#/components/schemas/LabelConfigurationBase'

    LabelConfigurationUpdateRequest:
      allOf:
        - $ref: '#/components/schemas/LabelConfigurationBase'

    LabelConfiguration:
      allOf:
        - $ref: '#/components/schemas/LabelConfigurationBase'
        - type: object
          properties:
            id:
              type: string
              example: cfg_001
          required: [id]

    LabelConfigurationBase:
      type: object
      properties:
        name:
          type: string
          maxLength: 100
        paperSize:
          type: string
          enum: [A4, Letter, Custom]
        pageOrientation:
          type: string
          enum: [portrait, landscape]
        pageWidth:
          type: number
          format: double
          minimum: 1
        pageHeight:
          type: number
          format: double
          minimum: 1
        labelWidth:
          type: number
          format: double
          minimum: 1
        labelHeight:
          type: number
          format: double
          minimum: 1
        labelsPerRow:
          type: integer
          minimum: 1
        labelsPerColumn:
          type: integer
          minimum: 1
        horizontalGap:
          type: number
          format: double
          minimum: 0
        verticalGap:
          type: number
          format: double
          minimum: 0
        topMargin:
          type: number
          format: double
          minimum: 0
        leftMargin:
          type: number
          format: double
          minimum: 0
        rightMargin:
          type: number
          format: double
          minimum: 0
        bottomMargin:
          type: number
          format: double
          minimum: 0
        template:
          $ref: '#/components/schemas/LabelTemplate'
      required:
        - paperSize
        - pageOrientation
        - pageWidth
        - pageHeight
        - labelWidth
        - labelHeight
        - labelsPerRow
        - labelsPerColumn
        - horizontalGap
        - verticalGap
        - topMargin
        - leftMargin
        - rightMargin
        - bottomMargin
        - template

    LabelTemplate:
      type: object
      properties:
        id:
          type: string
        name:
          type: string
        codeType:
          type: string
          enum: [CODE128, QR]
        showCode:
          type: boolean
        fontSize:
          type: integer
          minimum: 1
        fontFamily:
          type: string
          enum: [Roboto]
        fields:
          type: array
          minItems: 1
          items:
            $ref: '#/components/schemas/LabelField'
      required:
        - id
        - name
        - codeType
        - showCode
        - fontSize
        - fontFamily
        - fields

    LabelField:
      type: object
      properties:
        fieldName:
          type: string
          description: tenantName | name | barcode | price
        displayLabel:
          type: string
        visible:
          type: boolean
        fontSize:
          type: integer
          minimum: 1
        fontWeight:
          type: string
          enum: [normal, bold]
        alignment:
          type: string
          enum: [left, center, right]
        order:
          type: integer
          minimum: 1
      required:
        - fieldName
        - displayLabel
        - visible
        - fontSize
        - fontWeight
        - alignment
        - order
